// Declaration Quotation Create --> startcontactId
const formCreate = document.getElementById("formCreate");
const areaId = document.getElementById("area_id");
const btnPreview = document.getElementById("btnPreview");
const cityId = document.getElementById("city_id");
const clientId = document.getElementById("client_id");
const contactId = document.getElementById("contact_id");
const quotationCategory = document.getElementById("quotationCategory");
const quotationCategoryId = document.getElementById("quotation_category_id");
const number = document.getElementById("number");
const attachment = document.getElementById("attachment");
const subject = document.getElementById("subject");
const bodyTop = document.getElementById("body_top");
const products = document.getElementById("products");
const note = document.getElementById("note");
const bodyEnd = document.getElementById("body_end");
const priceType = document.getElementById("price_type");
// Declaration Quotation Create --> end

// Declaration Quotation Billboard --> start
const billboardQuotPreview = document.getElementById("billboardQuotPreview");
const quotationNumber = document.getElementById("quotationNumber");
const attachmentBillboard = document.getElementById("attachmentBillboard");
const subjectBillboard = document.getElementById("subjectBillboard");
const clientCompany = document.getElementById("clientCompany");
const clientContact = document.getElementById("clientContact");
const contactEmail = document.getElementById("contactEmail");
const contactPhone = document.getElementById("contactPhone");
const bodyTopBillboard = document.getElementById("bodyTopBillboard");
const btnAdd = document.getElementById("btnAdd");
const priceTypebillboard = document.getElementById("priceTypeBillboard");
const aMonth = document.getElementById("aMonth");
const quarterYear = document.getElementById("quarterYear");
const halfYear = document.getElementById("halfYear");
const aYear = document.getElementById("aYear");
const manualInput = document.getElementById("manualInput");
const billboardQuotation = document.getElementById("billboardQuotation");
const billboardTable = document.getElementById("billboardTable");
const thAMonth = document.getElementById("thAMonth");
const thQuarterYear = document.getElementById("thQuarterYear");
const thHalfYear = document.getElementById("thHalfYear");
const thAYear = document.getElementById("thAYear");
const thManual = document.getElementById("thManual");
const manualPrice = document.getElementById("manualPrice");
const billboardsTBody = document.getElementById("billboardsTBody");
const billboardNote = document.getElementById("billboardNote");
const billboardTArea = document.getElementById("billboardTArea");
const billboardNote01 = document.getElementById("billboardNote01");
const cbBillboardNote01 = document.getElementById("cbBillboardNote01");
const inputBBNote01 = document.getElementById("inputBBNote01");
const billboardNote02 = document.getElementById("billboardNote02");
const cbBillboardNote02 = document.getElementById("cbBillboardNote02");
const inputBBNote02 = document.getElementById("inputBBNote02");
const billboardNote03 = document.getElementById("billboardNote03");
const cbBillboardNote03 = document.getElementById("cbBillboardNote03");
const inputBBNote03 = document.getElementById("inputBBNote03");
const billboardNote04 = document.getElementById("billboardNote04");
const cbBillboardNote04 = document.getElementById("cbBillboardNote04");
const inputBBNote04 = document.getElementById("inputBBNote04");
const billboardNote05 = document.getElementById("billboardNote05");
const cbBillboardNote05 = document.getElementById("cbBillboardNote05");
const inputBBNote05 = document.getElementById("inputBBNote05");
const billboardNote06 = document.getElementById("billboardNote06");
const inputBBNote06 = document.getElementById("inputBBNote06");
const cbBillboardNote06 = document.getElementById("cbBillboardNote06");
const inputBBNote07 = document.getElementById("inputBBNote07");
const billboardNote07 = document.getElementById("billboardNote07");
const cbBillboardNote07 = document.getElementById("cbBillboardNote07");
const billboardNote08 = document.getElementById("billboardNote08");
const cbBillboardNote08 = document.getElementById("cbBillboardNote08");
const inputBBNote08 = document.getElementById("inputBBNote08");
const billboardNote09 = document.getElementById("billboardNote09");
const cbBillboardNote09 = document.getElementById("cbBillboardNote09");
const inputBBNote09 = document.getElementById("inputBBNote09");
const billboardNote10 = document.getElementById("billboardNote10");
const cbBillboardNote10 = document.getElementById("cbBillboardNote10");
const inputBBNote10 = document.getElementById("inputBBNote10");
// Declaration Quotation Billboard --> end

// Declaration Quotation Videotron --> start
const videotronQuotPreview = document.getElementById("videotronQuotPreview");
const quotationNumberVideotron = document.getElementById("quotationNumberVideotron");
const attachmentVideotron = document.getElementById("attachmentVideotron");
const quotationSubjectVideotron = document.getElementById("quotationSubjectVideotron");
const clientCompanyVideotron = document.getElementById("clientCompanyVideotron");
const clientContactVideotron = document.getElementById("clientContactVideotron");
const contactEmailVideotron = document.getElementById("contactEmailVideotron");
const contactPhoneVideotron = document.getElementById("contactPhoneVideotron");
const letterBodyVideotron = document.getElementById("letterBodyVideotron");
const btnAddVideotron = document.getElementById("btnAddVideotron");
const videotronQuotation = document.getElementById("videotronQuotation");
const videotronTable = document.getElementById("videotronTable");
const videotronsTBody = document.getElementById("videotronsTBody");
const videotronNote = document.getElementById("videotronNote");
const videotronTArea = document.getElementById("videotronTArea");
// Declaration Quotation Videotron --> end

// Declaration Quotation Add Locations --> start
const modal = document.getElementById("modal");
const btnCLose = document.getElementById("btn-close");
const search = document.getElementById("search");
const getSelected = document.getElementById("getSelected");
const locationsTable = document.getElementById("locationsTable");
const tHead4 = document.getElementById("tHead4");
const tHead5 = document.getElementById("tHead5");
const locationTBody = document.getElementById("locationTBody");
// Declaration Quotation Add Locations --> end

// Declaration Quotation Billboard Preview --> start
const modalPreview = document.getElementById("modalPreview");
const btsSavePrint = document.getElementById("btnSavePrint");
const btnClosePreview = document.getElementById("btnClosePreview");
const quotationNumberBBPreview = document.getElementById("quotationNumberBBPreview");
const attachmentBBPreview = document.getElementById("attachmentBBPreview");
const subjectBBPreview = document.getElementById("subjectBBPreview");
const clientBBPreview = document.getElementById("clientBBPreview");
const contactBBPreview = document.getElementById("contactBBPreview");
const contactEmailBBPreview = document.getElementById("contactEmailBBPreview");
const contactPhoneBBPreview = document.getElementById("contactPhoneBBPreview");
const letterBodyBBPreview = document.getElementById("letterBodyBBPreview");
const previewBBTBody = document.getElementById("previewBBTBody");
const previewBBthAMonth = document.getElementById("previewBBthAMonth");
const previewBBthQuarterYear = document.getElementById("previewBBthQuarterYear");
const previewBBthHalfYear = document.getElementById("previewBBthHalfYear");
const previewBBthAYear = document.getElementById("previewBBthAYear");
const previewBBthManual = document.getElementById("previewBBthManual");
const previewBBManualPrice = document.getElementById("previewBBManualPrice");
const tableWidth = document.getElementById("tableWidth");
const previewBBNote = document.getElementById("previewBBNote");
const previewBBNote01 = document.getElementById("previewBBNote01");
const inputPreviewBBNote01 = document.getElementById("inputPreviewBBNote01");
const previewBBNote02 = document.getElementById("previewBBNote02");
const inputPreviewBBNote02 = document.getElementById("inputPreviewBBNote02");
const previewBBNote03 = document.getElementById("previewBBNote03");
const inputPreviewBBNote03 = document.getElementById("inputPreviewBBNote03");
const previewBBNote04 = document.getElementById("previewBBNote04");
const inputPreviewBBNote04 = document.getElementById("inputPreviewBBNote04");
const previewBBNote05 = document.getElementById("previewBBNote05");
const previewBBNote06 = document.getElementById("previewBBNote06");
const inputPreviewBBNote06 = document.getElementById("inputPreviewBBNote06");
const previewBBNote07 = document.getElementById("previewBBNote07");
const inputPreviewBBNote07 = document.getElementById("inputPreviewBBNote07");
const previewBBNote08 = document.getElementById("previewBBNote08");
const lablePreviewBBNote08 = document.getElementById("lablePreviewBBNote08");
const previewBBNote09 = document.getElementById("previewBBNote09");
const inputPreviewBBNote09 = document.getElementById("inputPreviewBBNote09");
const previewBBNote10 = document.getElementById("previewBBNote10");
const inputPreviewBBNote10 = document.getElementById("inputPreviewBBNote10");
const locationsImage = document.getElementById("locationsImage");
// Declaration Quotation Billboard Preview --> end

// const btnSave = document.getElementById("btnSave");

let objCity = {};
let objContact = {};
let objBillboard = {};
let objVideotron = {};
let objSize = {};
let objLed = {};
let objProducts = {};
let locations = [];
let objNote = {};
let notes = [];
let objQuotationCity = {};
let objQuotation = {};

let dataQuotation = [];
let dataCity = [];
let dataContact = [];
let dataBillboard = [];
let dataVideotron = [];
let dataSize = [];
let dataLed = [];
let dataLocation = [];

let newRow = [];
let cell = [];
let sizeId = [];
let checkbox = [];
let radioButton = [];
let btnDel = [];
let inputPrice = [];
let previewInputPrice = [];

let iBillboard = 0;
let iSize = 0;
let iCity = 0;
let priceColumn = 0;

let area = '';

const optionCity = [];

// Get Quotation Data --> start
getQuotationData();
function getQuotationData() {
    const xhrQuotation = new XMLHttpRequest();
    const methodQuotation = "GET";
    const urlQuotation = "/showQuotation";

    xhrQuotation.open(methodQuotation, urlQuotation, true);
    xhrQuotation.send();

    xhrQuotation.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrQuotation.readyState === XMLHttpRequest.DONE) {
            const status = xhrQuotation.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objQuotation = JSON.parse(xhrQuotation.responseText);
                dataQuotation = objQuotation.dataQuotation;
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Quotation Data --> end

// Get City Data --> start
getDataCity();
function getDataCity() {
    const xhrCity = new XMLHttpRequest();
    const methodCity = "GET";
    const urlCity = "/showCity";

    xhrCity.open(methodCity, urlCity, true);
    xhrCity.send();

    xhrCity.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrCity.readyState === XMLHttpRequest.DONE) {
            const status = xhrCity.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objCity = JSON.parse(xhrCity.responseText);
                dataCity = objCity.dataCity;
                // console.log(dataCity);
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get City Data --> end

// Get Data Contact --> start
getDataContact();
function getDataContact() {
    const xhrContact = new XMLHttpRequest();
    const methodContact = "GET";
    const urlContact = "/showContact";

    xhrContact.open(methodContact, urlContact, true);
    xhrContact.send();

    xhrContact.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrContact.readyState === XMLHttpRequest.DONE) {
            const status = xhrContact.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objContact = JSON.parse(xhrContact.responseText);
                dataContact = objContact.dataContact;
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Data Contact --> end


// Add Quotation Number --> start
function addQuotationNumber() {
    const date = new Date();
    const year = date.getFullYear();
    let month = "";

    if (date.getMonth() + 1 == 1) {
        month = "I";
    } else if (date.getMonth() + 1 == 2) {
        month = "II";
    } else if (date.getMonth() + 1 == 3) {
        month = "III";
    } else if (date.getMonth() + 1 == 4) {
        month = "IV";
    } else if (date.getMonth() + 1 == 5) {
        month = "V";
    } else if (date.getMonth() + 1 == 6) {
        month = "VI";
    } else if (date.getMonth() + 1 == 7) {
        month = "VII";
    } else if (date.getMonth() + 1 == 8) {
        month = "VIII";
    } else if (date.getMonth() + 1 == 9) {
        month = "IX";
    } else if (date.getMonth() + 1 == 10) {
        month = "X";
    } else if (date.getMonth() + 1 == 11) {
        month = "XI";
    } else if (date.getMonth() + 1 == 12) {
        month = "XII";
    }

    number.value = "000" + (dataQuotation.length + 1) + "/Pen/VM/" + month + "-" + year;
}
// Add Quotation Number --> end

// Add attachment & quotation subject --> start
function getCategory(sel) {
    addQuotationNumber();
    areaId.value = 'Pilih Area';
    cityId.value = '';
    showCity();
    cityId.value = 'Pilih Kota';
    btnAdd.setAttribute('disabled', 'disabled');
    btnAdd.classList.add('btn-disabled');
    btnAdd.classList.remove('btn-primary');
    btnAddVideotron.setAttribute('disabled', 'disabled');
    btnAddVideotron.classList.add('btn-disabled');
    btnAddVideotron.classList.remove('btn-primary');
    quotationCategory.value = sel.options[sel.selectedIndex].text;
    if (quotationCategory.value == "Cetak") {
        btnPreview.classList.add('btn-primary');
        btnPreview.classList.remove('btn-disabled');
        btnPreview.removeAttribute('disabled');
        // attachment.innerHTML = "-";
        // quotationSubject.innerHTML = "Penawaran Biaya Cetak dan Pemasangan";
        // letterBody.innerHTML = '';
        // letterBody.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        areaId.removeAttribute('disabled');
        cityId.removeAttribute('disabled');
        clientId.removeAttribute('disabled');
        contactId.removeAttribute('disabled');
        // billboardQuotation.setAttribute('hidden', 'hidden');
        // videotronQuotation.setAttribute('hidden', 'hidden');
        // billboardNote.setAttribute('hidden', 'hidden');
        // videotronNote.setAttribute('hidden', 'hidden');
        priceTypebillboard.removeAttribute('hidden');
        videotronQuotPreview.setAttribute('hidden', 'hidden');
        billboardQuotPreview.setAttribute('hidden', 'hidden');
    } else if (quotationCategory.value == "Billboard") {
        btnPreview.classList.add('btn-primary');
        btnPreview.classList.remove('btn-disabled');
        btnPreview.removeAttribute('disabled');
        quotationNumber.innerHTML = number.value;
        subjectBillboard.innerHTML = "Penawaran Harga Penggunaan Media Reklame Billboard";
        bodyTopBillboard.innerHTML = '';
        bodyTopBillboard.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        areaId.removeAttribute('disabled');
        cityId.removeAttribute('disabled');
        clientId.removeAttribute('disabled');
        contactId.removeAttribute('disabled');
        // billboardQuotation.removeAttribute('hidden');
        // videotronQuotation.setAttribute('hidden', 'hidden');
        // billboardNote.removeAttribute('hidden');
        // videotronNote.setAttribute('hidden', 'hidden');
        priceTypebillboard.removeAttribute('hidden');
        billboardQuotPreview.removeAttribute('hidden');
        videotronQuotPreview.setAttribute('hidden', 'hidden');
        attachmentBillboard.innerHTML = "Foto dan Denah Lokasi";
    } else if (quotationCategory.value == "Videotron") {
        btnPreview.classList.add('btn-primary');
        btnPreview.classList.remove('btn-disabled');
        btnPreview.removeAttribute('disabled');
        quotationNumberVideotron.innerHTML = number.value;
        attachmentVideotron.innerHTML = "Foto dan Denah Lokasi";
        quotationSubjectVideotron.innerHTML = "Penawaran Harga Penggunaan Media Reklame Videotron";
        letterBodyVideotron.innerHTML = '';
        letterBodyVideotron.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        areaId.removeAttribute('disabled');
        cityId.removeAttribute('disabled');
        clientId.removeAttribute('disabled');
        contactId.removeAttribute('disabled');
        // billboardQuotation.setAttribute('hidden', 'hidden');
        // videotronQuotation.removeAttribute('hidden');
        // billboardNote.setAttribute('hidden', 'hidden');
        // videotronNote.removeAttribute('hidden');
        priceTypebillboard.setAttribute('hidden', 'hidden');
        videotronQuotPreview.removeAttribute('hidden');
        billboardQuotPreview.setAttribute('hidden', 'hidden');
    } else if (quotationCategory.value == "Signage") {
        btnPreview.classList.add('btn-primary');
        btnPreview.classList.remove('btn-disabled');
        btnPreview.removeAttribute('disabled');
        // attachment.innerHTML = "Foto dan Denah Lokasi";
        // quotationSubject.innerHTML = "Penawaran Harga Penggunaan Media Reklame Signage";
        // letterBody.innerHTML = '';
        // letterBody.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        areaId.removeAttribute('disabled');
        cityId.removeAttribute('disabled');
        clientId.removeAttribute('disabled');
        contactId.removeAttribute('disabled');
        // billboardQuotation.setAttribute('hidden', 'hidden');
        // videotronQuotation.setAttribute('hidden', 'hidden');
        // billboardNote.setAttribute('hidden', 'hidden');
        // videotronNote.setAttribute('hidden', 'hidden');
        priceTypebillboard.removeAttribute('hidden');
        videotronQuotPreview.setAttribute('hidden', 'hidden');
        billboardQuotPreview.setAttribute('hidden', 'hidden');
    } else {
        // attachment.innerHTML = "-";
        // quotationSubject.innerHTML = "-";
        // letterBody.innerHTML = '';
        // letterBody.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ........................ area ............. dengan spesifikasi sebagai berikut :';
        btnPreview.classList.add('btn-disabled');
        btnPreview.classList.remove('btn-primary');
        btnPreview.setAttribute('disabled', 'disabled');
        areaId.setAttribute('disabled', 'disabled');
        cityId.setAttribute('disabled', 'disabled');
        clientId.setAttribute('disabled', 'disabled');
        contactId.setAttribute('disabled', 'disabled');
        // billboardQuotation.setAttribute('hidden', 'hidden');
        // videotronQuotation.setAttribute('hidden', 'hidden');
        // billboardNote.setAttribute('hidden', 'hidden');
        // videotronNote.setAttribute('hidden', 'hidden');
        priceType.setAttribute('hidden', 'hidden');
        videotronQuotPreview.setAttribute('hidden', 'hidden');
        billboardQuotPreview.setAttribute('hidden', 'hidden');
    }
}

// Add attachment & quotation subject --> end

// Show City --> start
showCity();
function showCity() {
    optionCity[0] = document.createElement('option');
    optionCity[0].appendChild(document.createTextNode(['Pilih Kota']));
    optionCity[0].setAttribute('value', 'Pilih Kota');
    cityId.appendChild(optionCity[0]);

    if (cityId.value != '') {
        while (cityId.hasChildNodes()) {
            cityId.removeChild(cityId.firstChild);
        }
        // console.log(inputCity.value);
        optionCity[0] = document.createElement('option');
        optionCity[0].appendChild(document.createTextNode(['Pilih Kota']));
        optionCity[0].setAttribute('value', 'Pilih Kota');
        cityId.appendChild(optionCity[0]);

        for (i = 0; i < dataCity.length; i++) {
            if (dataCity[i]['area_id'] == areaId.value) {
                optionCity[i + 1] = document.createElement('option');
                optionCity[i + 1].appendChild(document.createTextNode(dataCity[i]['city']));
                if (cityId.value == dataCity[i]['id']) {
                    optionCity[i + 1].setAttribute('selected', 'selected');
                }
                optionCity[i + 1].setAttribute('value', dataCity[i]['id']);
                cityId.appendChild(optionCity[i + 1]);
            }
        }
    } else if (areaId.value != '') {
        while (cityId.hasChildNodes()) {
            cityId.removeChild(cityId.firstChild);
        }
        optionCity[0] = document.createElement('option');
        optionCity[0].appendChild(document.createTextNode(['Pilih Kota']));
        optionCity[0].setAttribute('value', 'Pilih Kota');
        cityId.appendChild(optionCity[0]);

        for (i = 0; i < dataCity.length; i++) {
            if (dataCity[i]['area_id'] == areaId.value) {
                optionCity[i + 1] = document.createElement('option');
                optionCity[i + 1].appendChild(document.createTextNode(dataCity[i]['city']));
                optionCity[i + 1].setAttribute('value', dataCity[i]['id']);
                cityId.appendChild(optionCity[i + 1]);
            }
        }
    }
}

function getArea(sel) {
    while (billboardsTBody.hasChildNodes()) {
        billboardsTBody.removeChild(billboardsTBody.firstChild);
    }
    while (videotronsTBody.hasChildNodes()) {
        videotronsTBody.removeChild(videotronsTBody.firstChild);
    }
    area = sel.options[sel.selectedIndex].text;
    if (quotationCategory.value != '' && sel.options[sel.selectedIndex].text != 'Pilih Area') {
        subjectBillboard.innerHTML = '';
        subjectBillboard.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + sel.options[sel.selectedIndex].text;
        bodyTopBillboard.innerHTML = '';
        bodyTopBillboard.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' dengan spesifikasi sebagai berikut :';
        quotationSubjectVideotron.innerHTML = '';
        quotationSubjectVideotron.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + sel.options[sel.selectedIndex].text;
        letterBodyVideotron.innerHTML = '';
        letterBodyVideotron.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' dengan spesifikasi sebagai berikut :';
        btnAdd.removeAttribute('disabled');
        btnAdd.classList.remove('btn-disabled');
        btnAdd.classList.add('btn-primary');
        btnAddVideotron.removeAttribute('disabled');
        btnAddVideotron.classList.remove('btn-disabled');
        btnAddVideotron.classList.add('btn-primary');
    } else {
        subjectBillboard.innerHTML = '';
        subjectBillboard.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value;
        bodyTopBillboard.innerHTML = '';
        bodyTopBillboard.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        quotationSubjectVideotron.innerHTML = '';
        quotationSubjectVideotron.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value;
        letterBodyVideotron.innerHTML = '';
        letterBodyVideotron.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ............. dengan spesifikasi sebagai berikut :';
        btnAdd.setAttribute('disabled', 'disabled');
        btnAdd.classList.add('btn-disabled');
        btnAdd.classList.remove('btn-primary');
        btnAddVideotron.setAttribute('disabled', 'disabled');
        btnAddVideotron.classList.add('btn-disabled');
        btnAddVideotron.classList.remove('btn-primary');
    }

    if (quotationCategory.value == "Billboard") {
        if (sel.options[sel.selectedIndex].text == 'Bali') {
            cbBillboardNote08.setAttribute('checked', 'checked');
        } else {
            cbBillboardNote08.removeAttribute('checked');
        }
        dataLocation = [];
        let n = 0;
        for (i = 0; i < dataBillboard.length; i++) {
            if (dataBillboard[i].area_id == areaId.value) {
                dataLocation[n] = {
                    id: dataBillboard[i].id,
                    area: dataBillboard[i].area_id,
                    city: dataBillboard[i].city_id,
                    code: dataBillboard[i].code,
                    address: dataBillboard[i].address,
                    category: dataBillboard[i].category,
                    lighting: dataBillboard[i].lighting,
                    photo: dataBillboard[i].photo,
                    lat: dataBillboard[i].lat,
                    lng: dataBillboard[i].lng,
                    road: dataBillboard[i].road_segment,
                    distance: dataBillboard[i].max_distance,
                    speed: dataBillboard[i].speed_average,
                    sector: dataBillboard[i].sector,
                    size: dataBillboard[i].size_id,
                    price: dataBillboard[i].price
                };
                n++;
            }
        }
    } else if (quotationCategory.value == "Videotron") {
        if (sel.options[sel.selectedIndex].text == 'Bali') {
            videotronTArea.removeAttribute('hidden');
        } else {
            videotronTArea.setAttribute('hidden', 'hidden');
        }
    } else {
        cbBillboardNote08.removeAttribute('checked');
        videotronTArea.setAttribute('hidden', 'hidden');
    }

    while (cityId.hasChildNodes()) {
        cityId.removeChild(cityId.firstChild);
    }
    optionCity[0] = document.createElement('option');
    optionCity[0].appendChild(document.createTextNode(['Pilih Kota']));
    cityId.appendChild(optionCity[0]);

    for (i = 0; i < dataCity.length; i++) {
        if (dataCity[i]['area_id'] == areaId.value) {
            optionCity[i + 1] = document.createElement('option');
            optionCity[i + 1].appendChild(document.createTextNode(dataCity[i][
                'city'
            ]));
            // option[i + 1].setAttribute('value', i + 1);
            optionCity[i + 1].setAttribute('value', dataCity[i]['id']);
            cityId.appendChild(optionCity[i + 1]);
        }
    }
}

function getCity(sel) {
    while (billboardsTBody.hasChildNodes()) {
        billboardsTBody.removeChild(billboardsTBody.firstChild);
    }
    while (videotronsTBody.hasChildNodes()) {
        videotronsTBody.removeChild(videotronsTBody.firstChild);
    }
    if (quotationCategory.value != '' && sel.options[sel.selectedIndex].text != 'Pilih Kota' && area != 'Pilih Area') {
        subjectBillboard.innerHTML = '';
        subjectBillboard.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + area + ' Kota ' + sel.options[sel.selectedIndex].text;
        bodyTopBillboard.innerHTML = '';
        bodyTopBillboard.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' kota ' + sel.options[sel.selectedIndex].text + ' dengan spesifikasi sebagai berikut :';
        quotationSubjectVideotron.innerHTML = '';
        quotationSubjectVideotron.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + area + ' Kota ' + sel.options[sel.selectedIndex].text;
        letterBodyVideotron.innerHTML = '';
        letterBodyVideotron.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' kota ' + sel.options[sel.selectedIndex].text + ' dengan spesifikasi sebagai berikut :';
    } else {
        subjectBillboard.innerHTML = '';
        subjectBillboard.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + area;
        bodyTopBillboard.innerHTML = '';
        bodyTopBillboard.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' dengan spesifikasi sebagai berikut :';
        quotationSubjectVideotron.innerHTML = '';
        quotationSubjectVideotron.innerHTML = 'Penawaran Harga Penggunaan Media Reklame ' + quotationCategory.value + '<br> Area ' + area;
        letterBodyVideotron.innerHTML = '';
        letterBodyVideotron.innerHTML = 'Bersama ini kami menyampaikan surat penawaran penggunaan media reklame ' + quotationCategory.value + ' area ' + area + ' dengan spesifikasi sebagai berikut :';
    }

    if (quotationCategory.value == "Billboard") {
        if (sel.options[sel.selectedIndex].text == 'Denpasar' || sel.options[sel.selectedIndex].text == 'Badung') {
            cbBillboardNote08.setAttribute('checked', 'checked');
        } else {
            cbBillboardNote08.removeAttribute('checked');
        }
    } else if (quotationCategory.value == "Videotron") {
        if (sel.options[sel.selectedIndex].text == 'Denpasar' || sel.options[sel.selectedIndex].text == 'Badung') {
            videotronTArea.removeAttribute('hidden');
        } else {
            videotronTArea.setAttribute('hidden', 'hidden');
        }
    } else {
        cbBillboardNote08.removeAttribute('checked');
        videotronTArea.setAttribute('hidden', 'hidden');
    }
}
// Show City --> end

// Get Client --> start
function getClient(sel) {
    clientCompany.innerHTML = sel.options[sel.selectedIndex].text;
    clientCompanyVideotron.innerHTML = sel.options[sel.selectedIndex].text;

    while (contactId.hasChildNodes()) {
        contactId.removeChild(contactId.firstChild);
    }
    optionContact[0] = document.createElement('option');
    optionContact[0].appendChild(document.createTextNode(['Pilih Kontak']));
    contactId.appendChild(optionContact[0]);

    const xhrContact = new XMLHttpRequest();
    const methodContact = "GET";
    const urlContact = "/showContact";

    xhrContact.open(methodContact, urlContact, true);
    xhrContact.send();

    xhrContact.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrContact.readyState === XMLHttpRequest.DONE) {
            const status = xhrContact.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                // The request has been completed successfully
                objContact = JSON.parse(xhrContact.responseText);
                for (i = 0; i < objContact.dataContact.length; i++) {
                    if (objContact.dataContact[i]['client_id'] == clientId.value) {
                        optionContact[i + 1] = document.createElement('option');
                        optionContact[i + 1].appendChild(document.createTextNode(objContact.dataContact[
                            i][
                            'name'
                        ]));
                        optionContact[i + 1].value = objContact.dataContact[i]['id'];
                        // option[i + 1].setAttribute('value', i + 1);
                        contactId.appendChild(optionContact[i + 1]);
                    }
                }
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Client --> end

// Show Contact --> start
const optionContact = [];
optionContact[0] = document.createElement('option');
optionContact[0].appendChild(document.createTextNode(['Pilih Kontak']));
contactId.appendChild(optionContact[0]);

if (contactId.value != '') {
    while (contactId.hasChildNodes()) {
        contactId.removeChild(contactId.firstChild);
    }
    // console.log(inputContact.value);
    optionContact[0] = document.createElement('option');
    optionContact[0].appendChild(document.createTextNode(['Pilih Kontak']));
    contactId.appendChild(optionContact[0]);

    for (i = 0; i < dataContact.length; i++) {
        if (dataContact[i]['client_id'] == clientId.value) {
            optionContact[i + 1] = document.createElement('option');
            optionContact[i + 1].appendChild(document.createTextNode(dataContact[i][
                'name'
            ]));
            if (inputContact.value == dataContact[i]['name']) {
                optionContact[i + 1].setAttribute('selected', 'selected');
            }
            contactId.appendChild(optionContact[i + 1]);
        }
    }
} else if (clientId.value != '') {
    while (contactId.hasChildNodes()) {
        contactId.removeChild(contactId.firstChild);
    }
    optionContact[0] = document.createElement('option');
    optionContact[0].appendChild(document.createTextNode(['Pilih Kontak']));
    contactId.appendChild(optionContact[0]);

    for (i = 0; i < dataContact.length; i++) {
        if (dataContact[i]['client_id'] == clientId.value) {
            optionContact[i + 1] = document.createElement('option');
            optionContact[i + 1].appendChild(document.createTextNode(dataContact[i][
                'name'
            ]));
            contactId.appendChild(optionContact[i + 1]);
        }
    }
}

// Get Contact --> start
function getContact(sel) {
    clientContact.innerHTML = 'UP. ' + sel.options[sel.selectedIndex].text;
    clientContactVideotron.innerHTML = 'UP. ' + sel.options[sel.selectedIndex].text;

    for (i = 0; i < dataContact.length; i++) {
        if (dataContact[i]['name'] == sel.options[sel.selectedIndex].text) {
            contactEmail.innerHTML = dataContact[i]['email'];
            contactPhone.innerHTML = dataContact[i]['phone'];
            contactEmailVideotron.innerHTML = dataContact[i]['email'];
            contactPhoneVideotron.innerHTML = dataContact[i]['phone'];
        }
    }
}
// Get Contact --> end

// Show Contact --> end

// Get Object Size --> start
getDataSize()
function getDataSize() {
    const xhrSize = new XMLHttpRequest();
    const methodSize = "GET";
    const urlSize = "/showSize";

    xhrSize.open(methodSize, urlSize, true);
    xhrSize.send();

    xhrSize.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrSize.readyState === XMLHttpRequest.DONE) {
            const status = xhrSize.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objSize = JSON.parse(xhrSize.responseText);
                dataSize = objSize.dataSize;
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Object Size --> end

// Get Object Led --> start
const xhrLed = new XMLHttpRequest();
const methodLed = "GET";
const urlLed = "/showLed";

xhrLed.open(methodLed, urlLed, true);
xhrLed.send();

xhrLed.onreadystatechange = () => {
    // In local files, status is 0 upon success in Mozilla Firefox
    if (xhrLed.readyState === XMLHttpRequest.DONE) {
        const status = xhrLed.status;
        if (status === 0 || (status >= 200 && status < 400)) {
            objLed = JSON.parse(xhrLed.responseText);
            dataLed = objLed.dataLed;
        } else {
            // Oh no! There has been an error with the request!
        }
    }
}
// Get Object Led --> end

// Get Object Billboard --> start
getDataBillboard();
function getDataBillboard() {
    const xhrBillboard = new XMLHttpRequest();
    const methodBillboard = "GET";
    const urlBillboard = "/showProduct";

    xhrBillboard.open(methodBillboard, urlBillboard, true);
    xhrBillboard.send();

    xhrBillboard.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrBillboard.readyState === XMLHttpRequest.DONE) {
            const status = xhrBillboard.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objBillboard = JSON.parse(xhrBillboard.responseText);
                dataBillboard = objBillboard.dataProduct;
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Object Billboard --> end

// Get Object Videotron --> start
getDataVideotron();
function getDataVideotron() {
    const xhrVideotron = new XMLHttpRequest();
    const methodVideotron = "GET";
    const urlVideotron = "/showVideotron";

    xhrVideotron.open(methodVideotron, urlVideotron, true);
    xhrVideotron.send();

    xhrVideotron.onreadystatechange = () => {
        // In local files, status is 0 upon success in Mozilla Firefox
        if (xhrVideotron.readyState === XMLHttpRequest.DONE) {
            const status = xhrVideotron.status;
            if (status === 0 || (status >= 200 && status < 400)) {
                objVideotron = JSON.parse(xhrVideotron.responseText);
                dataVideotron = objVideotron.dataVideotron;
            } else {
                // Oh no! There has been an error with the request!
            }
        }
    }
}
// Get Object Videotron --> end

// Preview --> start
btnPreview.addEventListener('click', function () {
    if (quotationCategoryId.value == 'Pilih Katagori') {
        alert('Anda belum memilih katagori')
    } else if (areaId.value == 'Pilih Area') {
        alert('Anda belum memilih area')
    } else if (clientId.value == 'Pilih Klien') {
        alert('Anda belum memilih klien')
    } else if (contactId.value == 'Pilih Kontak') {
        alert('Anda belum memilih kontak')
    } else if (locations.length == 0) {
        alert('Anda belum memilih lokasi billboard')
    } else {
        if (locations.length != 0) {
            while (locationsImage.hasChildNodes()) {
                locationsImage.removeChild(locationsImage.firstChild);
            }
            for (i = 0; i < locations.length; i++) {
                createImageLocations(locations, i);
            }
        } else {
            while (locationsImage.hasChildNodes()) {
                locationsImage.removeChild(locationsImage.firstChild);
            }
        }

        modalPreview.classList.remove('hidden');
        modalPreview.classList.add('flex');
        window.scrollTo(0, 0);
        quotationNumberBBPreview.innerHTML = quotationNumber.textContent;
        attachmentBBPreview.innerHTML = attachmentBillboard.textContent;
        attachment.value = "";
        attachment.value = attachmentBBPreview.textContent;
        subjectBBPreview.innerHTML = subjectBillboard.textContent;
        subject.value = "";
        subject.value = subjectBBPreview.textContent;
        clientBBPreview.innerHTML = clientCompany.textContent;
        contactBBPreview.innerHTML = clientContact.textContent;
        contactEmailBBPreview.innerHTML = contactEmail.textContent;
        contactPhoneBBPreview.innerHTML = contactPhone.textContent;
        letterBodyBBPreview.innerHTML = bodyTopBillboard.textContent;
        bodyTop.value = "";
        bodyTop.value = letterBodyBBPreview.textContent;
        // console.log(bodyTop.value);

        while (previewBBTBody.hasChildNodes()) {
            previewBBTBody.removeChild(previewBBTBody.firstChild);
        }
        if (manualInput.checked == true) {
            previewBBManualPrice.value = manualPrice.value;
        }
        for (iBillboard = 0; iBillboard < locations.length; iBillboard++) {
            newRow[iBillboard] = previewBBTBody.insertRow(iBillboard);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = iBillboard + 1;
            cell[0].classList.add('td-table-preview');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].code;
            cell[1].classList.add('td-table-preview');
            cell[2] = newRow[iBillboard].insertCell(2);
            cell[2].innerHTML = locations[iBillboard].address;
            cell[2].classList.add('text-[0.7rem]');
            cell[2].classList.add('text-teal-700');
            cell[2].classList.add('border');
            cell[3] = newRow[iBillboard].insertCell(3);
            cell[3].innerHTML = "BB";
            cell[3].classList.add('td-table-preview');
            cell[4] = newRow[iBillboard].insertCell(4);
            cell[4].innerHTML = locations[iBillboard].lighting;
            cell[4].classList.add('td-table-preview');
            cell[5] = newRow[iBillboard].insertCell(5);
            cell[5].innerHTML = locations[iBillboard].size;
            cell[5].classList.add('td-table-preview');
            cell[6] = newRow[iBillboard].insertCell(6);
            cell[6].innerHTML = 'Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.1) + ',-';
            cell[6].classList.add('td-table-preview');
            if (aMonth.checked == true) {
                cell[6].removeAttribute('hidden');
            } else {
                cell[6].setAttribute('hidden', 'hidden');
            }
            cell[7] = newRow[iBillboard].insertCell(7);
            cell[7].innerHTML = 'Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.275) + ',-';
            cell[7].classList.add('td-table-preview');
            if (quarterYear.checked == true) {
                cell[7].removeAttribute('hidden');
            } else {
                cell[7].setAttribute('hidden', 'hidden');
            }
            cell[8] = newRow[iBillboard].insertCell(8);
            cell[8].innerHTML = 'Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.525) + ',-';
            cell[8].classList.add('td-table-preview');
            if (halfYear.checked == true) {
                cell[8].removeAttribute('hidden');
            } else {
                cell[8].setAttribute('hidden', 'hidden');
            }
            cell[9] = newRow[iBillboard].insertCell(9);
            cell[9].innerHTML = 'Rp. ' + Intl.NumberFormat('en-US').format(locations[iBillboard].price) + ',-';
            cell[9].classList.add('td-table-preview');
            if (aYear.checked == true) {
                cell[9].removeAttribute('hidden');
            } else {
                cell[9].setAttribute('hidden', 'hidden');
            }
            cell[10] = newRow[iBillboard].insertCell(10);
            previewInputPrice[iBillboard] = document.createElement('input');
            previewInputPrice[iBillboard].classList.add('input-price-preview');
            previewInputPrice[iBillboard].setAttribute('readonly', 'readonly');
            previewInputPrice[iBillboard].value = 'Rp. ' + Intl.NumberFormat('en-US').format(inputPrice[iBillboard].value) + ',-';
            cell[10].appendChild(previewInputPrice[iBillboard]);
            cell[10].classList.add('td-table');
            if (manualInput.checked == true) {
                cell[10].removeAttribute('hidden');
            } else {
                cell[10].setAttribute('hidden', 'hidden');
            }
        }
        objProducts = { locations };
        products.value = "";
        products.value = JSON.stringify(objProducts);

        for (i = 0; i < 10; i++) {
            if (i + 1 == 1) {
                if (cbBillboardNote01.checked == true) {
                    previewBBNote01.removeAttribute('hidden');
                    inputPreviewBBNote01.value = inputBBNote01.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote01.value
                    }
                } else {
                    previewBBNote01.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 2) {
                if (cbBillboardNote02.checked == true) {
                    previewBBNote02.removeAttribute('hidden');
                    inputPreviewBBNote02.value = inputBBNote02.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote02.value
                    }
                } else {
                    previewBBNote02.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 3) {
                if (cbBillboardNote03.checked == true) {
                    previewBBNote03.removeAttribute('hidden');
                    inputPreviewBBNote03.value = inputBBNote03.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote03.value
                    }
                } else {
                    previewBBNote03.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 4) {
                if (cbBillboardNote04.checked == true) {
                    previewBBNote04.removeAttribute('hidden');
                    inputPreviewBBNote04.value = inputBBNote04.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote04.value
                    }
                } else {
                    previewBBNote04.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 5) {
                if (cbBillboardNote05.checked == true) {
                    previewBBNote05.removeAttribute('hidden');
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: "Sistem Pembayaran :"
                    }
                } else {
                    previewBBNote05.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: "Sistem Pembayaran :"
                    }
                }
            } else if (i + 1 == 6) {
                if (cbBillboardNote06.checked == true) {
                    previewBBNote06.removeAttribute('hidden');
                    inputPreviewBBNote06.value = inputBBNote06.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote06.value
                    }
                } else {
                    previewBBNote06.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 7) {
                if (cbBillboardNote07.checked == true) {
                    previewBBNote07.removeAttribute('hidden');
                    inputPreviewBBNote07.value = inputBBNote07.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote07.value
                    }
                } else {
                    previewBBNote07.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 8) {
                if (cbBillboardNote08.checked == true) {
                    previewBBNote08.removeAttribute('hidden');
                    lablePreviewBBNote08.innerHTML = inputBBNote08.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: lablePreviewBBNote08.textContent
                    }
                } else {
                    previewBBNote08.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 9) {
                if (cbBillboardNote09.checked == true) {
                    previewBBNote09.removeAttribute('hidden');
                    inputPreviewBBNote09.value = inputBBNote09.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote09.value
                    }
                } else {
                    previewBBNote09.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            } else if (i + 1 == 10) {
                if (cbBillboardNote10.checked == true) {
                    previewBBNote10.removeAttribute('hidden');
                    inputPreviewBBNote10.value = inputBBNote10.value;
                    notes[i] = {
                        cbNote: true,
                        labelNote: "-",
                        textNote: inputPreviewBBNote10.value
                    }
                } else {
                    previewBBNote10.setAttribute('hidden', 'hidden');
                    notes[i] = {
                        cbNote: false,
                        labelNote: "",
                        textNote: ""
                    }
                }
            }
        }
        objNote = { notes };
        note.value = "";
        note.value = JSON.stringify(objNote);
    }
    bodyEnd.value = "Demikian surat penawaran ini kami sampaikan, atas perhatian dan kerjasamanya kami ucapkan terima kasih";
    if (manualInput.checked == true) {
        priceType.value = "Harga Manual";
    } else {
        priceType.value = "Harga Otomatis";
    }

})

// Preview --> end

// Add Billboard Location --> start
btnAdd.addEventListener('click', function () {
    while (locationTBody.hasChildNodes()) {
        locationTBody.removeChild(locationTBody.firstChild);
    }

    let orientation = "";
    tHead4.innerHTML = "";
    tHead5.innerHTML = "";

    modal.classList.remove('hidden');
    modal.classList.add('flex');
    window.scrollTo(0, 0);
    if (quotationCategory.value == 'Billboard') {
        tHead4.innerHTML = "Jenis";
        tHead5.innerHTML = "BL/FL";
        if (locations.length == 0) {
            for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
                if (cityId.value == 'Pilih Kota') {
                    if (dataLocation[iBillboard]['area'] == areaId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataLocation[iBillboard].city == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataLocation[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataLocation[iBillboard].address;
                        cell[2].classList.add('text-sm');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "BB";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        if (dataLocation[iBillboard].lighting == 'Frontlight') {
                            cell[4].innerHTML = "FL";
                        } else if (dataLocation[iBillboard].lighting == 'Backlight') {
                            cell[4].innerHTML = "BL";
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataLocation[iBillboard].size == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataLocation[iBillboard]
                            .price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        checkbox[iBillboard] = document.createElement('input');
                        checkbox[iBillboard].setAttribute('type', 'checkbox');
                        checkbox[iBillboard].setAttribute('value', dataLocation[iBillboard].code);
                        checkbox[iBillboard].setAttribute('onclick', 'checkboxClick()');
                        // checkbox[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(checkbox[iBillboard]);
                        // show Size --> end
                    }
                } else {
                    if (dataLocation[iBillboard]['area'] == areaId.value && dataLocation[iBillboard]['city'] == cityId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataLocation[iBillboard].city == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataLocation[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataLocation[iBillboard].address;
                        cell[2].classList.add('text-sm');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "BB";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        if (dataLocation[iBillboard].lighting == 'Frontlight') {
                            cell[4].innerHTML = "FL";
                        } else if (dataLocation[iBillboard].lighting == 'Backlight') {
                            cell[4].innerHTML = "BL";
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataLocation[iBillboard].size == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataLocation[iBillboard]
                            .price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        checkbox[iBillboard] = document.createElement('input');
                        checkbox[iBillboard].setAttribute('type', 'checkbox');
                        checkbox[iBillboard].setAttribute('value', dataLocation[iBillboard].code);
                        checkbox[iBillboard].setAttribute('onclick', 'checkboxClick()');
                        // checkbox[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(checkbox[iBillboard]);
                        // show Size --> end
                    }
                }
            }
        } else {
            console.log(locations.length);
            for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
                if (cityId.value == 'Pilih Kota') {
                    if (dataLocation[iBillboard]['area'] == areaId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataLocation[iBillboard].city == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataLocation[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataLocation[iBillboard].address;
                        cell[2].classList.add('text-xs');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "BB";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        if (dataLocation[iBillboard].lighting == 'Frontlight') {
                            cell[4].innerHTML = "FL";
                        } else if (dataLocation[iBillboard].lighting == 'Backlight') {
                            cell[4].innerHTML = "BL";
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataLocation[iBillboard].size == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataLocation[iBillboard]
                            .price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        checkbox[iBillboard] = document.createElement('input');
                        checkbox[iBillboard].setAttribute('type', 'checkbox');
                        checkbox[iBillboard].setAttribute('value', dataLocation[iBillboard].code);
                        checkbox[iBillboard].setAttribute('onclick', 'checkboxClick()');
                        for (i = 0; i < locations.length; i++) {
                            if (locations[i].code == dataLocation[iBillboard].code) {
                                checkbox[iBillboard].checked = true;
                            }
                        }
                        // checkbox[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(checkbox[iBillboard]);
                        // show Size --> end
                    }
                } else {
                    if (dataLocation[iBillboard]['area'] == areaId.value && dataLocation[iBillboard]['city'] == cityId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataLocation[iBillboard].city == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataLocation[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataLocation[iBillboard].address;
                        cell[2].classList.add('text-xs');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "BB";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        if (dataLocation[iBillboard].lighting == 'Frontlight') {
                            cell[4].innerHTML = "FL";
                        } else if (dataLocation[iBillboard].lighting == 'Backlight') {
                            cell[4].innerHTML = "BL";
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataLocation[iBillboard].size == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataLocation[iBillboard]
                            .price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        checkbox[iBillboard] = document.createElement('input');
                        checkbox[iBillboard].setAttribute('type', 'checkbox');
                        checkbox[iBillboard].setAttribute('value', dataLocation[iBillboard].code);
                        checkbox[iBillboard].setAttribute('onclick', 'checkboxClick()');
                        for (i = 0; i < locations.length; i++) {
                            if (locations[i].code == dataLocation[iBillboard].code) {
                                checkbox[iBillboard].checked = true;
                            }
                        }
                        // checkbox[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(checkbox[iBillboard]);
                        // show Size --> end
                    }
                }
            }
        }
    }
    if (locations.length != 0) {
        if (locations.length < 5) {
            for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
                checkbox[iBillboard].removeAttribute('disabled');
            }
        } else {
            for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
                if (checkbox[iBillboard].checked == false) {
                    checkbox[iBillboard].setAttribute('disabled', 'disabled');
                }
            }
        }
    }
});

btnAddVideotron.addEventListener('click', function () {
    while (locationTBody.hasChildNodes()) {
        locationTBody.removeChild(locationTBody.firstChild);
    }

    let orientation = "";
    tHead4.innerHTML = "";
    tHead5.innerHTML = "";

    modal.classList.remove('hidden');
    modal.classList.add('flex');
    window.scrollTo(0, 0);

    if (quotationCategory.value == 'Videotron') {
        tHead4.innerHTML = "Jenis";
        tHead5.innerHTML = "Pixel";
        if (locations.length == 0) {
            for (iBillboard = 0; iBillboard < dataVideotron.length; iBillboard++) {
                if (cityId.value == 'Pilih Kota') {
                    if (dataVideotron[iBillboard]['area_id'] == areaId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataVideotron[iBillboard].city_id == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataVideotron[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataVideotron[iBillboard].address;
                        cell[2].classList.add('text-sm');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "VT";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        for (i = 0; i < dataLed.length; i++) {
                            if (dataVideotron[iBillboard].led_id == dataLed[i].id) {
                                cell[4].innerHTML = dataLed[i].pixel_pitch;
                            }
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataVideotron[iBillboard].size_id == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataVideotron[iBillboard]
                            .exclusive_price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        radioButton[iBillboard] = document.createElement('input');
                        radioButton[iBillboard].setAttribute('type', 'radio');
                        radioButton[iBillboard].setAttribute('value', dataVideotron[iBillboard].code);
                        // radioButton[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(radioButton[iBillboard]);
                        // show Size --> end
                    }
                } else {
                    if (dataVideotron[iBillboard]['area_id'] == areaId.value && dataVideotron[iBillboard]['city_id'] == cityId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataVideotron[iBillboard].city_id == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataVideotron[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataVideotron[iBillboard].address;
                        cell[2].classList.add('text-sm');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "VT";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        for (i = 0; i < dataLed.length; i++) {
                            if (dataVideotron[iBillboard].led_id == dataLed[i].id) {
                                cell[4].innerHTML = dataLed[i].pixel_pitch;
                            }
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataVideotron[iBillboard].size_id == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataVideotron[iBillboard]
                            .exclusive_price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        radioButton[iBillboard] = document.createElement('input');
                        radioButton[iBillboard].setAttribute('type', 'radio');
                        radioButton[iBillboard].setAttribute('value', dataVideotron[iBillboard].code);
                        // radioButton[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(radioButton[iBillboard]);
                        // show Size --> end
                    }
                }
            }
        } else {
            for (iBillboard = 0; iBillboard < dataVideotron.length; iBillboard++) {
                if (cityId.value == 'Pilih Kota') {
                    if (dataVideotron[iBillboard]['area_id'] == areaId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataVideotron[iBillboard].city_id == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataVideotron[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataVideotron[iBillboard].address;
                        cell[2].classList.add('text-xs');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "VT";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        for (i = 0; i < dataLed.length; i++) {
                            if (dataVideotron[iBillboard].led_id == dataLed[i].id) {
                                cell[4].innerHTML = dataLed[i].pixel_pitch;
                            }
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataVideotron[iBillboard].size_id == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataVideotron[iBillboard]
                            .exclusive_price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        radioButton[iBillboard] = document.createElement('input');
                        radioButton[iBillboard].setAttribute('type', 'radio');
                        radioButton[iBillboard].setAttribute('value', dataVideotron[iBillboard].code);
                        for (i = 0; i < locations.length; i++) {
                            if (locations[i].code == dataVideotron[iBillboard].code + ' - ' + cityCode) {
                                radioButton[iBillboard].checked = true;
                            }
                        }
                        // radioButton[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(radioButton[iBillboard]);
                        // show Size --> end
                    }
                } else {
                    if (dataVideotron[iBillboard]['area_id'] == areaId.value && dataVideotron[iBillboard]['city_id'] == cityId.value) {
                        newRow[iBillboard] = locationTBody.insertRow(iBillboard);
                        cell[0] = newRow[iBillboard].insertCell(0);
                        cell[0].innerHTML = iBillboard + 1;
                        cell[0].classList.add('td-table');
                        cell[1] = newRow[iBillboard].insertCell(1);
                        for (iCity = 0; iCity < dataCity.length; iCity++) {
                            if (dataVideotron[iBillboard].city_id == dataCity[iCity].id) {
                                var cityCode = dataCity[iCity].code;
                            }
                        }
                        cell[1].innerHTML = dataVideotron[iBillboard].code + ' - ' + cityCode;
                        cell[1].classList.add('td-table');
                        cell[2] = newRow[iBillboard].insertCell(2);
                        cell[2].innerHTML = dataVideotron[iBillboard].address;
                        cell[2].classList.add('text-xs');
                        cell[2].classList.add('text-teal-700');
                        cell[2].classList.add('border');
                        cell[3] = newRow[iBillboard].insertCell(3);
                        cell[3].innerHTML = "VT";
                        cell[3].classList.add('td-table');
                        cell[4] = newRow[iBillboard].insertCell(4);
                        for (i = 0; i < dataLed.length; i++) {
                            if (dataVideotron[iBillboard].led_id == dataLed[i].id) {
                                cell[4].innerHTML = dataLed[i].pixel_pitch;
                            }
                        }
                        cell[4].classList.add('td-table');
                        //show Size --> start
                        cell[5] = newRow[iBillboard].insertCell(5);
                        for (iSize = 0; iSize < objSize.dataSize.length; iSize++) {
                            if (dataVideotron[iBillboard].size_id == objSize.dataSize[iSize].id) {
                                orientation = objSize.dataSize[iSize].orientation;
                                if (orientation == "Vertikal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - V";
                                } else if (orientation == "Horizontal") {
                                    cell[5].innerHTML = objSize.dataSize[iSize].size + " - H";
                                }
                            }
                        }
                        cell[5].classList.add('td-table');
                        cell[6] = newRow[iBillboard].insertCell(6);
                        cell[6].innerHTML = Intl.NumberFormat('en-US').format(dataVideotron[iBillboard]
                            .exclusive_price);
                        cell[6].classList.add('td-table');
                        cell[7] = newRow[iBillboard].insertCell(7);
                        cell[7].classList.add('td-table');
                        radioButton[iBillboard] = document.createElement('input');
                        radioButton[iBillboard].setAttribute('type', 'radio');
                        radioButton[iBillboard].setAttribute('value', dataVideotron[iBillboard].code);
                        for (i = 0; i < locations.length; i++) {
                            if (locations[i].code == dataVideotron[iBillboard].code + ' - ' + cityCode) {
                                radioButton[iBillboard].checked = true;
                            }
                        }
                        // radioButton[iBillboard].setAttribute('onclick', 'deleteRow(this)');
                        cell[7].appendChild(radioButton[iBillboard]);
                        // show Size --> end
                    }
                }
            }
        }
    }
});

getSelected.addEventListener('click', function () {
    let i = 0;
    locations = [];
    if (quotationCategory.value == 'Billboard') {
        for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
            if (checkbox[iBillboard].checked == true) {
                for (iCity = 0; iCity < dataCity.length; iCity++) {
                    if (dataLocation[iBillboard].city == dataCity[iCity].id) {
                        var cityCode = dataCity[iCity].code;
                    }
                }

                for (iSize = 0; iSize < dataSize.length; iSize++) {
                    if (dataLocation[iBillboard].size == dataSize[iSize].id) {
                        var getSize = dataSize[iSize].size;
                        var getOrientation = dataSize[iSize].orientation;
                    }
                }
                locations[i] = {
                    id: dataLocation[iBillboard].id,
                    area: dataLocation[iBillboard].area_id,
                    city: cityCode,
                    code: dataLocation[iBillboard].code,
                    address: dataLocation[iBillboard].address,
                    photo: dataLocation[iBillboard].photo,
                    category: dataLocation[iBillboard].category,
                    lighting: dataLocation[iBillboard].lighting,
                    photo: dataLocation[iBillboard].photo,
                    lat: dataLocation[iBillboard].lat,
                    lng: dataLocation[iBillboard].lng,
                    road: dataLocation[iBillboard].road,
                    distance: dataLocation[iBillboard].max,
                    speed: dataLocation[iBillboard].speed,
                    sector: dataLocation[iBillboard].sector,
                    size: getSize,
                    orientation: getOrientation,
                    price: dataLocation[iBillboard].price,
                    id: dataLocation[iBillboard].id,
                };
                i++;
                // console.log(dataLocation[i].road_segment);
            }
        }
    } else if (quotationCategory.value == 'Videotron') {
        for (iBillboard = 0; iBillboard < dataVideotron.length; iBillboard++) {
            if (radioButton[iBillboard].checked == true) {
                locations[i] = {
                    id: dataVideotron[iBillboard].id,
                    code: locationTBody.rows[iBillboard].cells[1].innerHTML,
                    address: dataVideotron[iBillboard].address,
                    category: locationTBody.rows[iBillboard].cells[3].innerHTML,
                    pixelPitch: locationTBody.rows[iBillboard].cells[4].innerHTML,
                    pixelDensity: '10.000 pixel / m2',
                    viewDistancing: '> 9 meter',
                    vAngle: '110 °',
                    hAngle: '150 °',
                    startAt: '07.00',
                    endAt: '22.00',
                    videoDuration: '15 detik',
                    size: locationTBody.rows[iBillboard].cells[5].innerHTML,
                    exclusivePrice: dataVideotron[iBillboard].exclusive_price,
                    sharingPrice: dataVideotron[iBillboard].sharing_price
                };
                i++;
                // console.log(checkbox[iBillboard].value);
            }
        }
        console.log(locations);
    }
    modal.classList.remove('flex');
    modal.classList.add('hidden');

    if (quotationCategory.value == 'Billboard') {

        while (billboardsTBody.hasChildNodes()) {
            billboardsTBody.removeChild(billboardsTBody.firstChild);
        }

        for (iBillboard = 0; iBillboard < locations.length; iBillboard++) {
            newRow[iBillboard] = billboardsTBody.insertRow(iBillboard);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = iBillboard + 1;
            cell[0].classList.add('td-table');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].code;
            cell[1].classList.add('td-table');
            cell[2] = newRow[iBillboard].insertCell(2);
            cell[2].innerHTML = locations[iBillboard].address;
            cell[2].classList.add('text-xs');
            cell[2].classList.add('text-teal-700');
            cell[2].classList.add('border');
            cell[3] = newRow[iBillboard].insertCell(3);
            cell[3].innerHTML = "BB";
            cell[3].classList.add('td-table');
            cell[4] = newRow[iBillboard].insertCell(4);
            cell[4].innerHTML = locations[iBillboard].lighting;
            cell[4].classList.add('td-table');
            cell[5] = newRow[iBillboard].insertCell(5);
            cell[5].innerHTML = locations[iBillboard].size;
            cell[5].classList.add('td-table');
            cell[6] = newRow[iBillboard].insertCell(6);
            cell[6].innerHTML = Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.1);
            cell[6].classList.add('td-table');
            if (aMonth.checked == true) {
                cell[6].removeAttribute('hidden');
            } else {
                cell[6].setAttribute('hidden', 'hidden');
            }
            cell[7] = newRow[iBillboard].insertCell(7);
            cell[7].innerHTML = Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.275);
            cell[7].classList.add('td-table');
            if (quarterYear.checked == true) {
                cell[7].removeAttribute('hidden');
            } else {
                cell[7].setAttribute('hidden', 'hidden');
            }
            cell[8] = newRow[iBillboard].insertCell(8);
            cell[8].innerHTML = Intl.NumberFormat('en-US').format(Number(locations[iBillboard].price) * 0.525);
            cell[8].classList.add('td-table');
            if (halfYear.checked == true) {
                cell[8].removeAttribute('hidden');
            } else {
                cell[8].setAttribute('hidden', 'hidden');
            }
            cell[9] = newRow[iBillboard].insertCell(9);
            cell[9].innerHTML = Intl.NumberFormat('en-US').format(locations[iBillboard].price);
            cell[9].classList.add('td-table');
            if (aYear.checked == true) {
                cell[9].removeAttribute('hidden');
            } else {
                cell[9].setAttribute('hidden', 'hidden');
            }
            cell[10] = newRow[iBillboard].insertCell(10);
            inputPrice[iBillboard] = document.createElement('input');
            inputPrice[iBillboard].classList.add('input-price');
            inputPrice[iBillboard].setAttribute('placeholder', 'Input Harga');
            cell[10].appendChild(inputPrice[iBillboard]);
            cell[10].classList.add('td-table');
            if (manualInput.checked == true) {
                cell[10].removeAttribute('hidden');
            } else {
                cell[10].setAttribute('hidden', 'hidden');
            }
            // cell[11] = newRow[iBillboard].insertCell(11);
            // cell[11].classList.add('td-table');
            // btnDel[iBillboard] = document.createElement('button');
            // btnDel[iBillboard].setAttribute('type', 'button');
            // btnDel[iBillboard].classList.add('btn-del');
            // btnDel[iBillboard].classList.add('bg-red-600');
            // let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            // svg.classList.add('w-4');
            // svg.classList.add('fill-current');
            // svg.setAttribute('viewBox', '0 0 24 24');
            // newpath = document.createElementNS("http://www.w3.org/2000/svg", "path");
            // newpath.setAttributeNS(null, "d",
            //     "m12.002 2.005c5.518 0 9.998 4.48 9.998 9.997 0 5.518-4.48 9.998-9.998 9.998-5.517 0-9.997-4.48-9.997-9.998 0-5.517 4.48-9.997 9.997-9.997zm0 1.5c-4.69 0-8.497 3.807-8.497 8.497s3.807 8.498 8.497 8.498 8.498-3.808 8.498-8.498-3.808-8.497-8.498-8.497zm0 7.425 2.717-2.718c.146-.146.339-.219.531-.219.404 0 .75.325.75.75 0 .193-.073.384-.219.531l-2.717 2.717 2.727 2.728c.147.147.22.339.22.531 0 .427-.349.75-.75.75-.192 0-.384-.073-.53-.219l-2.729-2.728-2.728 2.728c-.146.146-.338.219-.53.219-.401 0-.751-.323-.751-.75 0-.192.073-.384.22-.531l2.728-2.728-2.722-2.722c-.146-.147-.219-.338-.219-.531 0-.425.346-.749.75-.749.192 0 .385.073.531.219z"
            // );
            // svg.appendChild(newpath);
            // btnDel[iBillboard].appendChild(svg);
            // btnDel[iBillboard].setAttribute('value', locations[iBillboard].code);
            // btnDel[iBillboard].setAttribute('onclick', 'deleteRow(this)');
            // cell[11].appendChild(btnDel[iBillboard]);
        }
    } else if (quotationCategory.value == 'Videotron') {
        const exclusiveAMoth = document.createElement('label');
        const exclusiveQuarter = document.createElement('label');
        const exclusiveHalf = document.createElement('label');
        const exclusivePriceLabel = document.createElement('label');
        const divExclusive1 = document.createElement('div');
        const divExclusive2 = document.createElement('div');
        const sharingAMoth = document.createElement('label');
        const sharingQuarter = document.createElement('label');
        const sharingHalf = document.createElement('label');
        const sharingPriceLabel = document.createElement('label');
        const divSharing1 = document.createElement('div');
        const divSharing2 = document.createElement('div');
        const inputExAMonth = document.createElement('input');
        const inputExQuarter = document.createElement('input');
        const inputExHalf = document.createElement('input');
        const inputExAYear = document.createElement('input');
        const inputShareAMonth = document.createElement('input');
        const inputShareQuarter = document.createElement('input');
        const inputShareHalf = document.createElement('input');
        const inputShareAYear = document.createElement('input');

        while (billboardsTBody.hasChildNodes()) {
            billboardsTBody.removeChild(billboardsTBody.firstChild);
        }

        for (iBillboard = 0; iBillboard < locations.length; iBillboard++) {
            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Kode Lokasi';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].code;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 1);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Lokasi';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].address;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 2);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Ukuran';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].size;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 3);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Ukuran Pixel';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].pixelPitch;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 4);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Kerapatan Pixel';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].pixelDensity;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 5);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Sudut Pandang';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].vAngle + ' vertikal, ' + locations[iBillboard].hAngle + ' horizontal';
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 6);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Jarak Pandang Optimal';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].viewDistancing;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 7);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Durasi Tayang';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].startAt + ' s.d ' + locations[iBillboard].endAt + ' (15 jam/hari)';
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 8);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Durasi Video';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            cell[1].innerHTML = locations[iBillboard].videoDuration;
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 9);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Harga Eksklusif';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            divExclusive1.classList.add('flex');
            inputExAMonth.setAttribute('type', 'checkbox');
            inputExAMonth.setAttribute('checked', 'checked');
            inputExAMonth.classList.add('mx-1');
            divExclusive1.appendChild(inputExAMonth);
            exclusiveAMoth.classList.add('w-56');
            exclusiveAMoth.innerHTML = '1 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].exclusivePrice) * 0.1) + ',-';
            divExclusive1.appendChild(exclusiveAMoth);
            inputExQuarter.setAttribute('type', 'checkbox');
            inputExQuarter.setAttribute('checked', 'checked');
            inputExQuarter.classList.add('mx-1');
            divExclusive1.appendChild(inputExQuarter);
            exclusiveQuarter.classList.add('w-56');
            exclusiveQuarter.innerHTML = '3 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].exclusivePrice) * 0.275) + ',-';
            divExclusive1.appendChild(exclusiveQuarter);
            cell[1].appendChild(divExclusive1);
            divExclusive2.classList.add('flex');
            inputExHalf.setAttribute('type', 'checkbox');
            inputExHalf.setAttribute('checked', 'checked');
            inputExHalf.classList.add('mx-1');
            divExclusive2.appendChild(inputExHalf);
            exclusiveHalf.classList.add('w-56');
            exclusiveHalf.innerHTML = '6 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].exclusivePrice) * 0.525) + ',-';
            exclusivePriceLabel.classList.add('w-56');
            exclusivePriceLabel.innerHTML = '1 Tahun = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].exclusivePrice)) + ',-';
            inputExAYear.setAttribute('type', 'checkbox');
            inputExAYear.setAttribute('checked', 'checked');
            inputExAYear.classList.add('mx-1');
            divExclusive2.appendChild(exclusiveHalf);
            divExclusive2.appendChild(inputExAYear);
            divExclusive2.appendChild(exclusivePriceLabel);
            cell[1].appendChild(divExclusive2);
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');

            newRow[iBillboard] = videotronsTBody.insertRow(iBillboard + 10);
            cell[0] = newRow[iBillboard].insertCell(0);
            cell[0].innerHTML = 'Harga Sharing (4 Klien)';
            cell[0].classList.add('text-sm');
            cell[0].classList.add('text-teal-700');
            cell[0].classList.add('px-2');
            cell[0].classList.add('border');
            cell[1] = newRow[iBillboard].insertCell(1);
            divSharing1.classList.add('flex');
            inputShareAMonth.setAttribute('type', 'checkbox');
            inputShareAMonth.setAttribute('checked', 'checked');
            inputShareAMonth.classList.add('mx-1');
            divSharing1.appendChild(inputShareAMonth);
            sharingAMoth.classList.add('w-56');
            sharingAMoth.innerHTML = '1 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].sharingPrice) * 0.1) + ',-';
            divSharing1.appendChild(sharingAMoth);
            inputShareQuarter.setAttribute('type', 'checkbox');
            inputShareQuarter.setAttribute('checked', 'checked');
            inputShareQuarter.classList.add('mx-1');
            divSharing1.appendChild(inputShareQuarter);
            sharingQuarter.classList.add('w-56');
            sharingQuarter.innerHTML = '3 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].sharingPrice) * 0.275) + ',-';
            divSharing1.appendChild(sharingQuarter);
            cell[1].appendChild(divSharing1);
            divSharing2.classList.add('flex');
            inputShareHalf.setAttribute('type', 'checkbox');
            inputShareHalf.setAttribute('checked', 'checked');
            inputShareHalf.classList.add('mx-1');
            divSharing2.appendChild(inputShareHalf);
            sharingHalf.classList.add('w-56');
            sharingHalf.innerHTML = '6 Bulan = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].sharingPrice) * 0.525) + ',-';
            sharingPriceLabel.classList.add('w-56');
            sharingPriceLabel.innerHTML = '1 Tahun = Rp. ' + Intl.NumberFormat('en-US').format(Number(locations[iBillboard].sharingPrice)) + ',-';
            divSharing2.appendChild(sharingHalf);
            inputShareAYear.setAttribute('type', 'checkbox');
            inputShareAYear.setAttribute('checked', 'checked');
            inputShareAYear.classList.add('mx-1');
            divSharing2.appendChild(inputShareAYear);
            divSharing2.appendChild(sharingPriceLabel);
            cell[1].appendChild(divSharing2);
            cell[1].classList.add('text-sm');
            cell[1].classList.add('text-teal-700');
            cell[1].classList.add('px-2');
            cell[1].classList.add('border');
        }
    }
})

function deleteRow(r) {
    var i = r.parentNode.parentNode.rowIndex;
    var isi = r;
    billboardTable.deleteRow(i);
    console.log(isi);
    console.log(locations);
    for (iBillboard = 0; iBillboard < locations.length; iBillboard++) {
        // console.log(locations[iBillboard].code);
        // console.log(btnDel[iBillboard].value);
        if (locations[iBillboard].code == isi.value) {
            locations.splice(iBillboard, 1)
        }
    }
    console.log(locations);
}

btnCLose.addEventListener('click', function () {
    modal.classList.remove('flex');
    modal.classList.add('hidden');
});

btnClosePreview.addEventListener('click', function () {
    modalPreview.classList.remove('flex');
    modalPreview.classList.add('hidden');
});

// Add Billboard Location --> end

// Search locations --> start
function searchTable() {
    var filter, tr, td1, td2, i, txtValue1, txtValue2;
    filter = search.value.toUpperCase();
    tr = locationsTable.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
        td1 = tr[i].getElementsByTagName("td")[1];
        td2 = tr[i].getElementsByTagName("td")[2];
        if (td1 || td2) {
            txtValue1 = td1.textContent || td1.innerText;
            txtValue2 = td2.textContent || td2.innerText;
            if (txtValue1.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
}
// Search locations --> end

// aMonth event --> start
aMonth.addEventListener('click', function () {
    priceColumn = 0;
    if (aMonth.checked == true) {
        thAMonth.removeAttribute('hidden');
        previewBBthAMonth.removeAttribute('hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[6].removeAttribute('hidden');
            }
        }
    } else {
        thAMonth.setAttribute('hidden', 'hidden');
        previewBBthAMonth.setAttribute('hidden', 'hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[6].setAttribute('hidden', 'hidden');
            }
        }
    }
    if (aMonth.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (quarterYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (halfYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (aYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (manualInput.checked == true) {
        priceColumn = priceColumn + 1;
    }

    if (priceColumn == 1 || priceColumn == 2) {
        tableWidth.classList.add('w-[650px]');
        tableWidth.classList.remove('w-[700px]');
    } else {
        tableWidth.classList.add('w-[700px]');
        tableWidth.classList.remove('w-[650px]');
    }
})
// aMonth event --> end

// quarter year event --> start
quarterYear.addEventListener('click', function () {
    priceColumn = 0;
    if (quarterYear.checked == true) {
        thQuarterYear.removeAttribute('hidden');
        previewBBthQuarterYear.removeAttribute('hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[7].removeAttribute('hidden');
            }
        }
    } else {
        thQuarterYear.setAttribute('hidden', 'hidden');
        previewBBthQuarterYear.setAttribute('hidden', 'hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[7].setAttribute('hidden', 'hidden');
            }
        }
    }
    if (aMonth.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (quarterYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (halfYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (aYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (manualInput.checked == true) {
        priceColumn = priceColumn + 1;
    }

    if (priceColumn == 1 || priceColumn == 2) {
        tableWidth.classList.add('w-[650px]');
        tableWidth.classList.remove('w-[700px]');
    } else {
        tableWidth.classList.add('w-[700px]');
        tableWidth.classList.remove('w-[650px]');
    }
})
// quarter year event --> end

// half year event --> start
halfYear.addEventListener('click', function () {
    priceColumn = 0;
    if (halfYear.checked == true) {
        thHalfYear.removeAttribute('hidden');
        previewBBthHalfYear.removeAttribute('hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[8].removeAttribute('hidden');
            }
        }
    } else {
        thHalfYear.setAttribute('hidden', 'hidden');
        previewBBthHalfYear.setAttribute('hidden', 'hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[8].setAttribute('hidden', 'hidden');
            }
        }
    }
    if (aMonth.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (quarterYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (halfYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (aYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (manualInput.checked == true) {
        priceColumn = priceColumn + 1;
    }

    if (priceColumn == 1 || priceColumn == 2) {
        tableWidth.classList.add('w-[650px]');
        tableWidth.classList.remove('w-[700px]');
    } else {
        tableWidth.classList.add('w-[700px]');
        tableWidth.classList.remove('w-[650px]');
    }
})
// half year event --> end

// a year event --> start
aYear.addEventListener('click', function () {
    priceColumn = 0;
    if (aYear.checked == true) {
        thAYear.removeAttribute('hidden');
        previewBBthAYear.removeAttribute('hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[9].removeAttribute('hidden');
            }
        }
    } else {
        thAYear.setAttribute('hidden', 'hidden');
        previewBBthAYear.setAttribute('hidden', 'hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[9].setAttribute('hidden', 'hidden');
            }
        }
    }
    if (aMonth.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (quarterYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (halfYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (aYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (manualInput.checked == true) {
        priceColumn = priceColumn + 1;
    }

    if (priceColumn == 1 || priceColumn == 2) {
        tableWidth.classList.add('w-[650px]');
        tableWidth.classList.remove('w-[700px]');
    } else {
        tableWidth.classList.add('w-[700px]');
        tableWidth.classList.remove('w-[650px]');
    }
})
// a year event --> end

// manual input event --> start
manualInput.addEventListener('click', function () {
    priceColumn = 0;
    if (manualInput.checked == true) {
        aYear.checked = false;
        aYear.setAttribute('disabled', true);
        thAYear.setAttribute('hidden', 'hidden');
        previewBBthAYear.setAttribute('hidden', 'hidden');
        halfYear.checked = false;
        halfYear.setAttribute('disabled', true);
        thHalfYear.setAttribute('hidden', 'hidden');
        previewBBthHalfYear.setAttribute('hidden', 'hidden');
        quarterYear.checked = false;
        quarterYear.setAttribute('disabled', true);
        thQuarterYear.setAttribute('hidden', 'hidden');
        previewBBthQuarterYear.setAttribute('hidden', 'hidden');
        aMonth.checked = false;
        aMonth.setAttribute('disabled', true);
        thAMonth.setAttribute('hidden', 'hidden');
        previewBBthAMonth.setAttribute('hidden', 'hidden');
        thManual.removeAttribute('hidden');
        previewBBthManual.removeAttribute('hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[10].removeAttribute('hidden');
                billboardsTBody.rows[i].cells[9].setAttribute('hidden', 'hidden');
                billboardsTBody.rows[i].cells[8].setAttribute('hidden', 'hidden');
                billboardsTBody.rows[i].cells[7].setAttribute('hidden', 'hidden');
                billboardsTBody.rows[i].cells[6].setAttribute('hidden', 'hidden');
                previewBBTBody.rows[i].cells[10].removeAttribute('hidden');
                previewBBTBody.rows[i].cells[9].setAttribute('hidden', 'hidden');
                previewBBTBody.rows[i].cells[8].setAttribute('hidden', 'hidden');
                previewBBTBody.rows[i].cells[7].setAttribute('hidden', 'hidden');
                previewBBTBody.rows[i].cells[6].setAttribute('hidden', 'hidden');
            }
        }
    } else {
        aYear.checked = true;
        aYear.removeAttribute('disabled');
        thAYear.removeAttribute('hidden');
        previewBBthAYear.removeAttribute('hidden');
        halfYear.checked = true;
        halfYear.removeAttribute('disabled');
        thHalfYear.removeAttribute('hidden');
        previewBBthHalfYear.removeAttribute('hidden');
        quarterYear.checked = true;
        quarterYear.removeAttribute('disabled');
        thQuarterYear.removeAttribute('hidden');
        previewBBthQuarterYear.removeAttribute('hidden');
        aMonth.checked = true;
        aMonth.removeAttribute('disabled');
        thAMonth.removeAttribute('hidden');
        previewBBthAMonth.removeAttribute('hidden');
        thManual.setAttribute('hidden', 'hidden');
        previewBBthManual.setAttribute('hidden', 'hidden');
        if (locations.length != 0) {
            for (i = 0; i < locations.length; i++) {
                billboardsTBody.rows[i].cells[10].setAttribute('hidden', 'hidden');
                billboardsTBody.rows[i].cells[9].removeAttribute('hidden');
                billboardsTBody.rows[i].cells[8].removeAttribute('hidden');
                billboardsTBody.rows[i].cells[7].removeAttribute('hidden');
                billboardsTBody.rows[i].cells[6].removeAttribute('hidden');
                previewBBTBody.rows[i].cells[10].setAttribute('hidden', 'hidden');
                previewBBTBody.rows[i].cells[9].removeAttribute('hidden');
                previewBBTBody.rows[i].cells[8].removeAttribute('hidden');
                previewBBTBody.rows[i].cells[7].removeAttribute('hidden');
                previewBBTBody.rows[i].cells[6].removeAttribute('hidden');
            }
        }
    }
    if (aMonth.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (quarterYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (halfYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (aYear.checked == true) {
        priceColumn = priceColumn + 1;
    }
    if (manualInput.checked == true) {
        priceColumn = priceColumn + 1;
    }

    if (priceColumn == 1 || priceColumn == 2) {
        tableWidth.classList.add('w-[650px]');
        tableWidth.classList.remove('w-[700px]');
    } else {
        tableWidth.classList.add('w-[700px]');
        tableWidth.classList.remove('w-[650px]');
    }
})
// manual input event --> end

function checkboxClick() {
    let cbChecked = 0;
    cbChecked = 0;
    for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
        if (checkbox[iBillboard].checked == true) {
            cbChecked++;
        }
    }
    if (cbChecked < 5) {
        for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
            checkbox[iBillboard].removeAttribute('disabled');
        }
    } else {
        for (iBillboard = 0; iBillboard < dataLocation.length; iBillboard++) {
            if (checkbox[iBillboard].checked == false) {
                checkbox[iBillboard].setAttribute('disabled', 'disabled');
            }
        }
    }
}

document.getElementById("btnSavePrint").onclick = function () {
    formCreate.submit();
    var element = document.getElementById('pdfPreview');
    var opt = {
        margin: 0,
        filename: 'test.pdf',
        image: {
            type: 'jpeg',
            quality: 1
        },
        pagebreak: {
            mode: ['avoid-all', 'css', 'legacy']
        },
        html2canvas: {
            dpi: 192,
            scale: 4,
            letterRendering: true,
            useCORS: true
        },
        jsPDF: {
            unit: 'in',
            format: 'a4',
            orientation: 'portrait',
            putTotalPages: true
        }
    };
    // html2pdf(element, opt);
    html2pdf().set(opt).from(element).save();
};

function createImageLocations(locations, i) {
    var bgElement = document.createElement("div");

    var header = document.createElement("div");
    var logo = document.createElement("div");
    var imgLogo = document.createElement("img");
    var lineHeader = document.createElement("div");
    var lineHeaderImg = document.createElement("img");

    var body = document.createElement("div");
    var mainTitle = document.createElement("div");
    var title = document.createElement("div");
    var codeNumber = document.createElement("span");
    var codeCity = document.createElement("span");
    var codeLine = document.createElement("img");
    var addressPreview = document.createElement("span");

    var mainImage = document.createElement("div");
    var imageFrame = document.createElement("div");
    var imagePreview = document.createElement("img");

    var bodyBottom = document.createElement("div");
    var mainBottom = document.createElement("div");
    var mainMap = document.createElement("div");
    var mapTitle = document.createElement("div");
    var mapPreview = document.createElement("div");
    var imageMap = document.createElement("img");

    var mainDescription = document.createElement("div");
    var descriptionTitle = document.createElement("div");
    var description = document.createElement("div");
    var descriptionType = document.createElement("div");
    var typeName = document.createElement("span");
    var typeValue = document.createElement("span");
    var descriptionSize = document.createElement("div");
    var sizeName = document.createElement("span");
    var sizeValue = document.createElement("span");
    var descriptionOrientation = document.createElement("div");
    var orientationName = document.createElement("span");
    var orientationValue = document.createElement("span");
    var descriptionLighting = document.createElement("div");
    var lightingName = document.createElement("span");
    var lightingValue = document.createElement("span");
    var areaTitle = document.createElement("div");
    var areaInformation = document.createElement("div");
    var road = document.createElement("div");
    var roadName = document.createElement("span");
    var roadValue = document.createElement("span");
    var distance = document.createElement("div");
    var distanceName = document.createElement("span");
    var distanceValue = document.createElement("span");
    var speed = document.createElement("div");
    var speedName = document.createElement("span");
    var speedValue = document.createElement("span");
    var areal = document.createElement("div");
    var arealName = document.createElement("span");
    var qrCodeDisplay = document.createElement("div");
    var qrCodeMapDisplay = document.createElement("div");
    var arealValue = document.createElement("span");
    var sector = document.createElement("div");
    var sectors = document.createElement("div");
    var sectorsValue = [];

    var footer = document.createElement("div");
    var footerLine = document.createElement("div");
    var footerLineImg = document.createElement("img");
    var footerCompany = document.createElement("div");
    var company = document.createElement("span");
    var footerAddress = document.createElement("div");
    var address = document.createElement("span");
    var footerPhone = document.createElement("div");
    var phone = document.createElement("span");
    var footerEmail = document.createElement("div");
    var email = document.createElement("span");


    // Main element --> start
    bgElement.classList.add("w-[780px]");
    bgElement.classList.add("h-[1100px]");
    bgElement.classList.add("bg-white");
    locationsImage.appendChild(bgElement);
    // Main element --> end

    // Header element --> start
    header.classList.add("h-24");
    header.classList.add("mt-2");
    bgElement.appendChild(header);

    logo.classList.add("flex");
    logo.classList.add("w-full");
    logo.classList.add("justify-center");
    logo.classList.add("items-center");
    header.appendChild(logo);

    imgLogo.classList.add("mt-3");
    imgLogo.setAttribute('src', '/img/logo-vm.png');
    logo.appendChild(imgLogo);

    lineHeader.classList.add("flex");
    lineHeader.classList.add("w-full");
    lineHeader.classList.add("justify-center");
    lineHeader.classList.add("items-center");
    lineHeader.classList.add("mt-2");
    header.appendChild(lineHeader);

    lineHeaderImg.setAttribute('src', '/img/line-top.png');
    lineHeader.appendChild(lineHeaderImg);
    // Header element --> end

    // Body title element --> start
    body.classList.add("h-[875px]");
    body.classList.add("mt-6");
    bgElement.appendChild(body);

    mainTitle.classList.add("main-title");

    title.classList.add("title");
    mainTitle.appendChild(title);

    codeNumber.classList.add("code-number");
    codeNumber.innerHTML = locations[i].code;

    codeCity.classList.add("code-city");
    codeCity.innerHTML = "- " + locations[i].city;
    codeLine.classList.add("h-10");
    codeLine.setAttribute('src', '/img/code-line.png');

    addressPreview.classList.add("address-preview");
    addressPreview.innerHTML = locations[i].address;
    title.appendChild(codeNumber);
    title.appendChild(codeCity);
    title.appendChild(codeLine);
    title.appendChild(addressPreview);
    // Body title element --> end

    // Body image element --> start
    mainImage.classList.add("main-image");
    imageFrame.classList.add("image-frame");
    imagePreview.classList.add("image-preview");
    imagePreview.setAttribute('src', '/storage/' + locations[i].photo);
    mainImage.appendChild(imageFrame);
    imageFrame.appendChild(imagePreview);
    // Body image element --> end

    // Body bottom element --> start
    bodyBottom.classList.add("body-bottom");
    mainBottom.classList.add("main-bottom");
    mainMap.classList.add("main-map");
    mapTitle.classList.add("map-title");
    mapTitle.innerHTML = "Google Maps Koordinat : " + Number(locations[i].lat).toFixed(7) + ',  ' + Number(locations[i].lng).toFixed(7);
    mapPreview.classList.add("map-preview");
    mapPreview.classList.add("items-end");
    imageMap.classList.add("image-map");
    imageMap.setAttribute('src', 'https://maps.googleapis.com/maps/api/staticmap?center=' + locations[i].lat + ',' + locations[i].lng + '&zoom=15&size=476x330&maptype=roadmap&markers=icon:https://vistamedia.co.id/img/marker-red.png%7C' + locations[i].lat + ',' + locations[i].lng + '&key=AIzaSyCZT6TYRimJY8YoPn0cABAdGnbVLGVusWg');
    qrCodeMapDisplay.classList.add("mb-2");
    qrCodeMapDisplay.classList.add("ml-2");
    qrCodeMapDisplay.classList.add("absolute");
    qrCodeMapDisplay.classList.add("w-[100px]")
    new QRCode(qrCodeMapDisplay, 'https://www.google.co.id/maps/place/' + locations[i].lat + ',' + locations[i].lng + '/@' + locations[i].lat + ',' + locations[i].lng + ',15z');
    mapPreview.appendChild(imageMap);
    mapPreview.appendChild(qrCodeMapDisplay);
    mainMap.appendChild(mapTitle);
    mainMap.appendChild(mapPreview);


    mainDescription.classList.add("main-description");
    descriptionTitle.classList.add("description-title");
    descriptionTitle.innerHTML = "Deskripsi Billboard";
    description.classList.add("description");
    descriptionType.classList.add("description-element");
    typeName.classList.add("description-name");
    typeName.innerHTML = "Jenis";
    typeValue.classList.add("description-value");
    typeValue.innerHTML = ': ' + locations[i].category;
    descriptionSize.classList.add("description-element");
    sizeName.classList.add("description-name");
    sizeName.innerHTML = "Ukuran";
    sizeValue.classList.add("description-value");
    sizeValue.innerHTML = ': ' + locations[i].size;
    descriptionOrientation.classList.add("description-element");
    orientationName.classList.add("description-name");
    orientationName.innerHTML = "Orientasi";
    orientationValue.classList.add("description-value");
    orientationValue.innerHTML = ': ' + locations[i].orientation;
    descriptionLighting.classList.add("description-element");
    lightingName.classList.add("description-name");
    lightingName.innerHTML = "Penerangan";
    lightingValue.classList.add("description-value");
    lightingValue.innerHTML = ': ' + locations[i].lighting;
    areaTitle.classList.add("area-title");
    areaTitle.innerHTML = "Informasi Area";
    areaInformation.classList.add("area-information");
    road.classList.add("area-element");
    roadName.classList.add("area-name");
    roadName.innerHTML = "Type Jalan";
    roadValue.classList.add("area-value");
    roadValue.innerHTML = ': ' + locations[i].road;
    distance.classList.add("area-element");
    distanceName.classList.add("area-name");
    distanceName.innerHTML = "Jarak Pandang";
    distanceValue.classList.add("area-value");
    distanceValue.innerHTML = ': ' + locations[i].distance;
    speed.classList.add("area-element");
    speedName.classList.add("area-name");
    speedName.innerHTML = "Kecepatan";
    speedValue.classList.add("area-value");
    speedValue.innerHTML = ': ' + locations[i].speed;
    areal.classList.add("area-element");
    arealName.classList.add("area-name");
    arealName.innerHTML = "Kawasan";
    qrCodeDisplay.classList.add("mt-10");
    new QRCode(qrCodeDisplay, "https://vistamedia.co.id/preview/" + locations[i].id);
    arealName.appendChild(qrCodeDisplay);
    arealValue.classList.add("area-value");
    const sectorText = locations[i].sector;
    const sectorData = sectorText.split("-");
    for (z = 0; z < sectorData.length; z++) {
        if (sectorData[z] != sectorData[sectorData.length - 1]) {
            sectorsValue[z] = document.createElement("div");
            sectorsValue[z].innerHTML = '- ' + sectorData[z];
            sectors.appendChild(sectorsValue[z]);
        }
    }
    sector.innerHTML = ": ";
    arealValue.appendChild(sector);
    arealValue.appendChild(sectors);

    descriptionType.appendChild(typeName);
    descriptionType.appendChild(typeValue);
    description.appendChild(descriptionType);
    descriptionSize.appendChild(sizeName);
    descriptionSize.appendChild(sizeValue);
    description.appendChild(descriptionSize);
    descriptionOrientation.appendChild(orientationName);
    descriptionOrientation.appendChild(orientationValue);
    description.appendChild(descriptionOrientation);
    descriptionLighting.appendChild(lightingName);
    descriptionLighting.appendChild(lightingValue);
    description.appendChild(descriptionLighting);

    road.appendChild(roadName);
    road.appendChild(roadValue);
    areaInformation.appendChild(road);
    distance.appendChild(distanceName);
    distance.appendChild(distanceValue);
    areaInformation.appendChild(distance);
    speed.appendChild(speedName);
    speed.appendChild(speedValue);
    areaInformation.appendChild(speed);
    areal.appendChild(arealName);
    areal.appendChild(arealValue);
    areaInformation.appendChild(areal);

    mainDescription.appendChild(descriptionTitle);
    mainDescription.appendChild(description);
    mainDescription.appendChild(areaTitle);
    mainDescription.appendChild(areaInformation);


    mainBottom.appendChild(mainMap);
    mainBottom.appendChild(mainDescription);
    bodyBottom.appendChild(mainBottom);
    // Body bottom element --> end

    body.appendChild(mainTitle);
    body.appendChild(mainImage);
    body.appendChild(bodyBottom);

    // Footer element --> start
    footer.classList.add("footer");
    footerLine.classList.add("footer-line");
    footerLineImg.classList.add("footter-line-img");
    footerLineImg.setAttribute('src', '/img/line-bottom.png');
    footerCompany.classList.add("footer-company");
    company.innerHTML = "PT. Vista Media";
    company.classList.add("company");
    footerAddress.classList.add("footer-element");
    address.classList.add("footer-text");
    address.innerHTML = "Jl. Pulau Kawe No. 40 - Denpasar | Bali - Indonesia"
    footerPhone.classList.add("footer-element");
    phone.classList.add("footer-text");
    phone.innerHTML = "Ph. +62 361 230000 | Fax. +62 361 237800";
    footerEmail.classList.add("footer-element");
    email.classList.add("footer-text");
    email.innerHTML = "e-mail : info@vistamedia.co.id | www.vistamedia.co.id";

    footerLine.appendChild(footerLineImg);
    footer.appendChild(footerLine);
    footerCompany.appendChild(company);
    footer.appendChild(footerCompany);
    footerAddress.appendChild(address);
    footer.appendChild(footerAddress);
    footerPhone.appendChild(phone);
    footer.appendChild(footerPhone);
    footerEmail.appendChild(email);
    footer.appendChild(footerEmail);
    bgElement.appendChild(footer);
    // Footer element --> end
}
